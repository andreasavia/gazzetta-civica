---
import Base from '../layouts/Base.astro';
import { getCollection } from 'astro:content';

const articles = await getCollection('articoli', ({ data }) => !data.draft);
const sortedArticles = articles.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<Base title="Home">
  <div class="hero-wrapper">
    <section class="hero">
      <h1>Gazzetta Civica</h1>
      <p class="tagline">Trasparenza legislativa per una cittadinanza informata</p>
      <div class="intro">
        <p>
          Un archivio aperto della legislazione italiana.
          Raccogliamo, organizziamo e rendiamo accessibili le leggi e i decreti
          pubblicati in Gazzetta Ufficiale.
        </p>
      </div>
    </section>
  </div>

  <section class="content-section">
    <h2>Ultimi Aggiornamenti</h2>
    {sortedArticles.length === 0 ? (
      <p class="empty-state">
        Nessun articolo pubblicato ancora.
      </p>
    ) : (
      <ul class="article-list">
        {sortedArticles.map((article) => (
          <li class="article-item">
            <a href={`/gazzetta-civica/articoli/${article.slug}/`}>
              <h3>{article.data.title}</h3>
              <p class="article-date">
                {article.data.date.toLocaleDateString('it-IT', {
                  year: 'numeric',
                  month: 'long',
                  day: 'numeric'
                })}
              </p>
            </a>
          </li>
        ))}
      </ul>
    )}
  </section>
</Base>
